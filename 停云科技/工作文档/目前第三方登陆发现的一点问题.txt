
目前第三方登录有漏洞，主要在用户登录校验控制上

1、第三方登陆后直接链接我方用户系统的这个请求方法，全程无校验（https://www.goods.ph/facebookLogin.html?email=lngg057@gmail.com），只要获取到了该用户的邮箱地址，通过简单的拼接url后便可直接登录我们系统；
2、在第三方登陆与我用户系统进行首次关联的时候，最好不要直接创建新用户，如果非要创建的话，也不能像现在后台这样直接在用户密码进行固定的明码设置（123456），不然一旦外人知道这种做法，通过第三方登录的用户信息就完全没有保证；
3、操作同２，存在一种特殊情况：有用户Ａ之前用ｍ邮箱地址直接注册过我们网站，之后该邮箱弃用（长时间未使用被系统回收），之后正好用户Ｂ重新注册了该ｍ邮箱，并通过该邮箱生成的第三方账号登录我们系统。这时如果按照我们现有的登陆逻辑，会直接将B的信息关联到之前用户Ａ的帐号上。用户Ｂ登陆后会发现之前A购买的相关信息，这也是所谓的“串号”现象，之前有电商曾出现过这种问题，这种现象导致的结果影响比较严重。


可能的解决方法

1、在用户第一次进行第三方登陆的时候，跳转账户确认页面，与我方现有账户进行绑定（需要我方账号手动登录），或者直接让用户创建新账号进行绑定。如果一定要省掉这个步骤的话，在根据邮箱生成系统新用户的时候，也要确保后台生成的为随机或唯一的密码；这样的好处是能避免上面说的信息泄露问题，不好的地方就是用户不能直接通过该邮箱帐号直接登录了（但是可以通过账号找回的方式重新设定密码）；
2、在绑定之后进行登陆的操作时，需要在后台对从第三方获取的访问auth令牌进行校验是否伪造、是否越权、是否过期等，校验通过后，根据获取的当前登陆用户的邮箱信息（或者对应的第三方唯一userid），再调用登陆方法进行系统用户的登录操作，解决通过直接敲URL的方式避过任何的登录操作而进入系统